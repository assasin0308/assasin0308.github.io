<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>nodejs-2019-study | assasin&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="12官网:nodejs.org中文网: nodejs.cn  1. REPL执行js代码1231. 打开cmd2. 运行node3. .exit退出或ctl+c  2. 写文件操作12345678var fs &#x3D; require(&#39;fs&#39;); &#x2F;&#x2F;引入文件系统fs.writeFile(__dirname +&#39;&#x2F;shi.txt&#39;,&quot;床前明月光,疑似地上霜&quot;,&#39;utf8&#39;,function(err)&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="nodejs-2019-study">
<meta property="og:url" content="http://yoursite.com/2020/07/03/nodejs-2019-study/index.html">
<meta property="og:site_name" content="assasin&#39;s Blog">
<meta property="og:description" content="12官网:nodejs.org中文网: nodejs.cn  1. REPL执行js代码1231. 打开cmd2. 运行node3. .exit退出或ctl+c  2. 写文件操作12345678var fs &#x3D; require(&#39;fs&#39;); &#x2F;&#x2F;引入文件系统fs.writeFile(__dirname +&#39;&#x2F;shi.txt&#39;,&quot;床前明月光,疑似地上霜&quot;,&#39;utf8&#39;,function(err)&amp;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-07-03T09:39:38.000Z">
<meta property="article:modified_time" content="2020-07-03T09:40:19.816Z">
<meta property="article:author" content="assasin">
<meta property="article:tag" content="PHP linux Python Javascript Html">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="assasin&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">assasin&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">不要迷恋哥,哥只是个传说</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-nodejs-2019-study" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/03/nodejs-2019-study/" class="article-date">
  <time datetime="2020-07-03T09:39:38.000Z" itemprop="datePublished">2020-07-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      nodejs-2019-study
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">官网:nodejs.org</span><br><span class="line">中文网: nodejs.cn</span><br></pre></td></tr></table></figure>

<h3 id="1-REPL执行js代码"><a href="#1-REPL执行js代码" class="headerlink" title="1. REPL执行js代码"></a>1. REPL执行js代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 打开cmd</span><br><span class="line"><span class="number">2.</span> 运行node</span><br><span class="line"><span class="number">3.</span> .exit退出或ctl+c</span><br></pre></td></tr></table></figure>

<h3 id="2-写文件操作"><a href="#2-写文件操作" class="headerlink" title="2. 写文件操作"></a>2. 写文件操作</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>); <span class="comment">//引入文件系统</span></span><br><span class="line">fs.writeFile(__dirname +<span class="string">'/shi.txt'</span>,<span class="string">"床前明月光,疑似地上霜"</span>,<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (err)&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(err);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'写入成功'</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-读文件操作"><a href="#3-读文件操作" class="headerlink" title="3.读文件操作"></a>3.读文件操作</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>); <span class="comment">//引入文件系统</span></span><br><span class="line">fs.readFile(__dirname + <span class="string">'/test.txt'</span>,<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"读取失败"</span>,err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"读取到内容"</span>,data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">注意:若不传字符编码,则会读取到buffer对象,以<span class="number">16</span>进制显示</span><br></pre></td></tr></table></figure>

<h3 id="4-文件目录路径"><a href="#4-文件目录路径" class="headerlink" title="4. 文件目录路径"></a>4. 文件目录路径</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">global:</span><br><span class="line">__dirname </span><br><span class="line"></span><br><span class="line">__filename</span><br><span class="line"></span><br><span class="line">path.join() 拼接路径</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">path.join(__dirname,<span class="string">'shibin.log'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-异常处理"><a href="#5-异常处理" class="headerlink" title="5. 异常处理"></a>5. 异常处理</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">  cosole.log(<span class="string">'代码出错了'</span>,e);</span><br><span class="line">&#125;</span><br><span class="line">注意:文件操作不能使用<span class="keyword">try</span>捕获.</span><br></pre></td></tr></table></figure>

<h3 id="6-http-server"><a href="#6-http-server" class="headerlink" title="6. http_server"></a>6. http_server</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>); <span class="comment">//引入http模块</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(); <span class="comment">//创建http服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//监听指定端口号</span></span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'监听端口成功,通过访问:http://127.0.0.1:8888'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">request,response</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//request事件的处理函数</span></span><br><span class="line"><span class="comment">//  response.write('hello-world');</span></span><br><span class="line">  response.setHeader(<span class="string">"content-type"</span>,<span class="string">"text/html;charset=utf-8"</span>);<span class="comment">//设置响应头信息</span></span><br><span class="line">  response.setHeader(<span class="string">"name"</span>,<span class="string">"assasin"</span>);<span class="comment">//设置响应头信息</span></span><br><span class="line">  response.setHeader(<span class="string">"age"</span>,<span class="string">"16"</span>);<span class="comment">//设置响应头信息</span></span><br><span class="line">  <span class="comment">// response.writeHead(),也可设置响应头,可一次设置多条信息,包括状态码</span></span><br><span class="line">  response.writeHead(<span class="number">200</span>,<span class="string">"ok"</span>,&#123;</span><br><span class="line">    <span class="string">"content-type"</span>:<span class="string">"text/html;charset=utf-8"</span>,</span><br><span class="line">    <span class="string">"name"</span>:<span class="string">"assasin"</span>,</span><br><span class="line">    <span class="string">"age"</span>:<span class="number">18</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">//返回数据给浏览器,传字符串或buffer对象</span></span><br><span class="line">  response.write(<span class="string">"hello-world"</span>);</span><br><span class="line">  response.end(<span class="string">'响应结束'</span>);  <span class="comment">//结束响应</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">注意:设置响应头应在write()之前设置.</span><br></pre></td></tr></table></figure>

<h3 id="7-response-APIs"><a href="#7-response-APIs" class="headerlink" title="7. response APIs"></a>7. response APIs</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>); <span class="comment">//引入http模块</span></span><br><span class="line"><span class="keyword">var</span> server = http.createServer(); <span class="comment">//创建http服务</span></span><br><span class="line"><span class="comment">//监听指定端口号</span></span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'监听端口成功,通过访问:http://localhost:8888 进行测试'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">request,response</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//response 函数</span></span><br><span class="line">  <span class="comment">//response.statusCode() 状态码</span></span><br><span class="line">  <span class="comment">//response.statusMessage() 状态信息</span></span><br><span class="line">  response.statusCode = <span class="string">'502'</span>;</span><br><span class="line">  response.statusMessage = <span class="string">"Bad gateWay"</span>;</span><br><span class="line"></span><br><span class="line">  response.end(<span class="string">'响应结束'</span>);  <span class="comment">//结束响应</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="8-content-type"><a href="#8-content-type" class="headerlink" title="8. content-type"></a>8. content-type</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">浏览器在接收到服务器响应的数据后,会根据响应头中的content-type来进行处理.</span><br><span class="line">Content_Type:text/html</span><br><span class="line">Content_Type:text/css</span><br><span class="line">Content_Type:application/josn</span><br></pre></td></tr></table></figure>

<h3 id="9-模拟服务器"><a href="#9-模拟服务器" class="headerlink" title="9. 模拟服务器"></a>9. 模拟服务器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> mime = <span class="built_in">require</span>(<span class="string">'mime'</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(res.url == <span class="string">'/'</span>)&#123;</span><br><span class="line">    res.url = <span class="string">'/index.html'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  res.setHeader(<span class="string">"content-type"</span>,mime.getType(req.url));</span><br><span class="line">  fs.readFile(path.join(__dirname,<span class="string">'view'</span>,req.url),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">     res.statusCode = <span class="number">404</span>;</span><br><span class="line">     res.statusMessage = <span class="string">"Not Found"</span>;</span><br><span class="line">     res.end();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.end(data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="10-request常用属性"><a href="#10-request常用属性" class="headerlink" title="10. request常用属性"></a>10. request常用属性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">request.url:请求地址中的路径与参数</span><br><span class="line">request.headers: 请求头信息(对象)</span><br><span class="line">request.rawHeader:请求头信息(数组)</span><br><span class="line">request.httpVersion: http协议版本信息</span><br><span class="line">request.method:http请求方式</span><br></pre></td></tr></table></figure>

<h3 id="11-Get请求参数的获取"><a href="#11-Get请求参数的获取" class="headerlink" title="11. Get请求参数的获取"></a>11. Get请求参数的获取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8888?name=assasin&amp;age=18</span></span><br><span class="line">提取参数:&#123;<span class="string">"name"</span>:<span class="string">"assasin"</span>,<span class="string">"age"</span>:<span class="number">18</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//1.原生操作</span></span><br><span class="line">  <span class="comment">// var params = &#123;&#125;;</span></span><br><span class="line">  <span class="comment">// if(req.url.indexOf("?") != -1)&#123;</span></span><br><span class="line">  <span class="comment">//   var querystring = req.url.split('?')[1]; //name=assasin&amp;age=18</span></span><br><span class="line">  <span class="comment">//   querystring.split('&amp;').forEach(function(v,i)&#123;</span></span><br><span class="line">  <span class="comment">//     var temp = v.split('=');</span></span><br><span class="line">  <span class="comment">//     params[temp[0]] = temp[1];</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// console.log(params);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//2. 升级 使用querystring.parse()</span></span><br><span class="line">  <span class="comment">// if(req.url.indexOf("?") != -1)&#123;</span></span><br><span class="line">  <span class="comment">//   var str = req.url.split('?')[1];</span></span><br><span class="line">  <span class="comment">//   var params = querystring.parse(str);</span></span><br><span class="line">  <span class="comment">//   console.log(params);</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//3. 使用url.parse模块处理 第二个参数传 TRUE</span></span><br><span class="line"> <span class="keyword">var</span> urlObj = url.parse(req.url,<span class="literal">true</span>);</span><br><span class="line">  <span class="comment">// urlObj.pathname:路径部分内容</span></span><br><span class="line">  <span class="comment">//urlObj.query 参数部分内容 字符串 ----&gt;参数对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(urlObj.query);</span><br><span class="line">   res.end(<span class="string">'ok'</span>);</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="12-Post请求参数的获取"><a href="#12-Post请求参数的获取" class="headerlink" title="12. Post请求参数的获取"></a>12. Post请求参数的获取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//获取Post请求参数 请求体中</span></span><br><span class="line"><span class="comment">//  首先,定义一个数组,用于存放每次接收的数据</span></span><br><span class="line">  <span class="keyword">var</span> bufferlist = [];</span><br><span class="line">  <span class="comment">//1. 给req对象注册一个data事件,当有POST请求的数据发送至服务器时,就触发该事件</span></span><br><span class="line">  req.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//post请求的数据会分多次发送至服务器.每次发送给服务器都会触发data事件,每次发送的数据可以通过chunk接收, chunk是一个buffer对象</span></span><br><span class="line">  <span class="comment">//  console.log(chunk);</span></span><br><span class="line">    bufferlist.push(chunk);</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 2. 给req注册end事件,表示数据发送完毕</span></span><br><span class="line">  req.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//end事件会在POST数据发送完毕触发,所以只能在end 事件中获取</span></span><br><span class="line">    <span class="comment">//需要将数组中所有的buffer对象合并为一个buffer对象 buffer.concat()</span></span><br><span class="line">    <span class="keyword">var</span> result = Buffer.concat(bufferlist);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将result转为字符串即可 buffer--&gt;string</span></span><br><span class="line">  <span class="comment">//  console.log(result.toString());\</span></span><br><span class="line">    <span class="comment">//最后使用querystring将字符型转为对象</span></span><br><span class="line">    <span class="keyword">var</span> params = querystring.parse(result.toString());</span><br><span class="line">    <span class="built_in">console</span>.log(params);</span><br><span class="line">  &#125;)</span><br><span class="line">  res.end(<span class="string">'ok'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="13-npm简介"><a href="#13-npm简介" class="headerlink" title="13. npm简介"></a>13. npm简介</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm (node package manager) node的包管理工具.</span><br><span class="line">npm 服务器 </span><br><span class="line">npm 网站 www.npmjs.com</span><br><span class="line">npm 命令行工具</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">基本命令:()内参数可选</span><br><span class="line">npm init (-y) :初始化package.json文件</span><br><span class="line">npm install 包名:下载需要的资源包</span><br><span class="line">npm install 包名@版本号:下载指定版本的资源包</span><br><span class="line">npm i 包名:简写</span><br><span class="line"></span><br><span class="line">npm uninstall 包名: 卸载资源包</span><br><span class="line"></span><br><span class="line">npm install 包名 -g :全局安装</span><br><span class="line">npm install live-server -g </span><br><span class="line">npm install less -g</span><br></pre></td></tr></table></figure>

<h3 id="14-package-json文件的作用及属性说明"><a href="#14-package-json文件的作用及属性说明" class="headerlink" title="14. package.json文件的作用及属性说明"></a>14. package.json文件的作用及属性说明</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">package.json:用来描述一个包的信息.</span><br><span class="line">必须包含两个信息:name,version</span><br><span class="line">name:包名(不能包含中文,空格,大写字母,特殊字符!);</span><br><span class="line">version:包的版本信息;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"05-19"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"main"</span>: <span class="string">"exception.js"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"keywords"</span>: [],</span><br><span class="line">  <span class="string">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"mime"</span>: <span class="string">"^2.4.3"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-nrm"><a href="#15-nrm" class="headerlink" title="15. nrm"></a>15. nrm</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">设置npm让其从国内镜像下载.nrm</span><br><span class="line">npm install nrm -g </span><br><span class="line">查看服务器列表: nrm ls</span><br><span class="line">产看当前正在使用的服务器 nrm current</span><br><span class="line">切换服务器: nrm use 服务器名称</span><br><span class="line">测试服务器速度: nrm test 服务器名称</span><br></pre></td></tr></table></figure>

<h3 id="16-hacker-news-案例"><a href="#16-hacker-news-案例" class="headerlink" title="16. hacker_news 案例"></a>16. hacker_news 案例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> mime = <span class="built_in">require</span>(<span class="string">'mime'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> urlObj = url.parse(req.url,<span class="literal">true</span>);</span><br><span class="line">  <span class="comment">//1. 设置路由规则</span></span><br><span class="line"> <span class="comment">//   /index 首页</span></span><br><span class="line"> <span class="comment">//   /details 详情页</span></span><br><span class="line"> <span class="comment">//   /submit 添加页</span></span><br><span class="line">    <span class="keyword">if</span>(req.url == <span class="string">'/'</span> || req.url == <span class="string">"/index"</span>)&#123;</span><br><span class="line">       fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'index.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">           res.end(data);</span><br><span class="line">       &#125;)</span><br><span class="line"></span><br><span class="line">     <span class="comment">//  res.end('首页');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(urlObj.pathname == <span class="string">"/details"</span>)&#123;</span><br><span class="line">       fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'details.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">           res.end(data);</span><br><span class="line">       &#125;)</span><br><span class="line">      <span class="comment">//  res.end('详情页');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.url == <span class="string">'/submit'</span>) &#123;</span><br><span class="line">        fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'submit.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            res.end(data);</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">//  res.end('添加页面');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.url.indexOf(<span class="string">"/resource"</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">        res.setHeader(<span class="string">"content-type"</span>,mime.getType(req.url));</span><br><span class="line">       fs.readFile(path.join(__dirname,req.url),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">           res.end(data);</span><br><span class="line">       &#125;)</span><br><span class="line">     <span class="comment">//   res.end("静态资源");</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.statusCode = <span class="number">404</span>;</span><br><span class="line">        res.statusMessage = <span class="string">"Not Found"</span>;</span><br><span class="line">        res.end(<span class="string">"Not Found"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="17-使用文件存储数据"><a href="#17-使用文件存储数据" class="headerlink" title="17. 使用文件存储数据"></a>17. 使用文件存储数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">fs.readFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">    data = <span class="built_in">JSON</span>.parse(data || <span class="string">'[]'</span>); <span class="comment">//若为空 转为空数组</span></span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加新数据到data.json</span></span><br><span class="line"><span class="keyword">var</span> news = &#123;</span><br><span class="line">    <span class="string">"title"</span>:<span class="string">"123"</span>,</span><br><span class="line">    <span class="string">"url"</span>:<span class="string">""</span>,</span><br><span class="line">    <span class="string">"text"</span>:<span class="string">"睡大觉"</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">fs.readFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">    data = <span class="built_in">JSON</span>.parse(data || <span class="string">'[]'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将新数据添加至原有数据中</span></span><br><span class="line">    <span class="comment">//需要给news添加id属性</span></span><br><span class="line">    news.id = data.length == <span class="number">0</span> ? <span class="number">1</span> : data[data.length <span class="number">-1</span>].id +<span class="number">1</span> ;</span><br><span class="line">    data.push(news);</span><br><span class="line">    fs.writeFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="built_in">JSON</span>.stringify(data),<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"添加成功"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//根据id 查找对应数据</span></span><br><span class="line"><span class="comment">//读取所有数据 data.json</span></span><br><span class="line"><span class="keyword">var</span> id = <span class="number">1</span></span><br><span class="line">fs.readFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">   data = <span class="built_in">JSON</span>.parse(data || <span class="string">'[]'</span>);</span><br><span class="line">   <span class="comment">// data.forEach(function(v,i)&#123;</span></span><br><span class="line">   <span class="comment">//     if(v.id == id)&#123;</span></span><br><span class="line">   <span class="comment">//         console.log(v);</span></span><br><span class="line">   <span class="comment">//     &#125;</span></span><br><span class="line">   <span class="comment">// &#125;)</span></span><br><span class="line">    <span class="comment">// 找数组中满足条件的第一个元素</span></span><br><span class="line">    <span class="keyword">var</span> result = data.find(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> v.id == id;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="18-数组常用方法"><a href="#18-数组常用方法" class="headerlink" title="18. 数组常用方法"></a>18. 数组常用方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line"><span class="comment">//遍历数组</span></span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v + <span class="string">"====&gt;"</span> + i);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//映射 map</span></span><br><span class="line"><span class="keyword">var</span> newArr = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v * <span class="number">2</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(newArr); <span class="comment">// [ 2, 4, 6, 8, 10, 12, 14, 16, 18, 20 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// some方法 判断数组中是否有任意元素满足条件</span></span><br><span class="line"><span class="comment">//判断氏族中是否有偶数</span></span><br><span class="line"><span class="keyword">var</span> flag = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(flag); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断数组中是否满足所有条件</span></span><br><span class="line"><span class="keyword">var</span> flag = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v % <span class="number">2</span> !== <span class="number">0</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(flag);<span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//查找数组中第一个满足条件的元素</span></span><br><span class="line"><span class="keyword">var</span> first = arr.find(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(first); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在数组中找所有满足条件的元素</span></span><br><span class="line"><span class="keyword">var</span> newdata = arr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> v % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(newdata); <span class="comment">// [ 2, 4, 6, 8, 10 ]</span></span><br></pre></td></tr></table></figure>

<h3 id="19-art-template-使用"><a href="#19-art-template-使用" class="headerlink" title="19. art-template 使用"></a>19. art-template 使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 安装 npm install art-template </span><br><span class="line">    <span class="keyword">var</span> template = <span class="built_in">require</span>(<span class="string">'art-template'</span>);</span><br><span class="line">    <span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">    <span class="comment">//以文件作为模板渲染</span></span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">        msg: <span class="string">"hello-world"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result = template(path.join(__dirname,<span class="string">'tpl.html'</span>),obj);</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">    -------------------------------------------------------------</span><br><span class="line">    <span class="comment">//以字符串变量作为模板渲染</span></span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">"&lt;div&gt;&#123;&#123;msg&#125;&#125;&lt;/div&gt;"</span>;</span><br><span class="line">    <span class="comment">//1.根据模板字符串创建渲染函数</span></span><br><span class="line">    <span class="keyword">var</span> render = template.compile(str);</span><br><span class="line">    <span class="comment">//2.使用渲染函数 进行渲染</span></span><br><span class="line">    <span class="keyword">var</span> result  = render(obj);</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br></pre></td></tr></table></figure>

<h3 id="20-hacker-new-渲染数据"><a href="#20-hacker-new-渲染数据" class="headerlink" title="20. hacker_new 渲染数据"></a>20. hacker_new 渲染数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> mime = <span class="built_in">require</span>(<span class="string">'mime'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">var</span> template = <span class="built_in">require</span>(<span class="string">'art-template'</span>);</span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> urlObj = url.parse(req.url,<span class="literal">true</span>);</span><br><span class="line">  <span class="comment">//1. 设置路由规则</span></span><br><span class="line"> <span class="comment">//   /index 首页</span></span><br><span class="line"> <span class="comment">//   /details 详情页</span></span><br><span class="line"> <span class="comment">//   /submit 添加页</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(req.url == <span class="string">'/'</span> || req.url == <span class="string">"/index"</span>)&#123;</span><br><span class="line">       <span class="comment">// fs.readFile(path.join(__dirname,'views','index.html'),function(err,data)&#123;</span></span><br><span class="line">       <span class="comment">//     res.end(data);</span></span><br><span class="line">       <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="comment">//将数据渲染到页面</span></span><br><span class="line">        fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'index.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">            fs.readFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,newslist</span>)</span>&#123;</span><br><span class="line">                newlist = <span class="built_in">JSON</span>.parse(newslist || <span class="string">'[]'</span>);</span><br><span class="line">                <span class="comment">//data 是模板 newslist是数据</span></span><br><span class="line">                <span class="keyword">var</span> render = template.compile(data.toString());</span><br><span class="line">                <span class="keyword">var</span> result = render(&#123;<span class="attr">list</span>:newslist&#125;);</span><br><span class="line">                res.end(result);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">     <span class="comment">//  res.end('首页');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(urlObj.pathname == <span class="string">"/details"</span>)&#123;</span><br><span class="line">       <span class="comment">// fs.readFile(path.join(__dirname,'views','details.html'),function(err,data)&#123;</span></span><br><span class="line">       <span class="comment">//     res.end(data);</span></span><br><span class="line">       <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="comment">//读取到模板文件内容</span></span><br><span class="line">        fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'details.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            <span class="comment">//res.end(data);</span></span><br><span class="line">           <span class="comment">//获取id GET请求参数</span></span><br><span class="line">            fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'data.json'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,news</span>)</span>&#123;</span><br><span class="line">                <span class="comment">//res.end(data);</span></span><br><span class="line">                <span class="comment">//获取id GET请求参数</span></span><br><span class="line">                news = <span class="built_in">JSON</span>.parse(news || <span class="string">'[]'</span>);</span><br><span class="line">                <span class="keyword">var</span> news = news.find(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> v.id = urlObj.query.id;</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">var</span> render = template.compile(data.toString());</span><br><span class="line">                <span class="keyword">var</span> result = render(&#123;<span class="attr">item</span>:news&#125;);</span><br><span class="line">                res.end(result);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="comment">//  res.end('详情页');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.url == <span class="string">'/submit'</span>) &#123;</span><br><span class="line">        <span class="comment">// fs.readFile(path.join(__dirname,'views','submit.html'),function(err,data)&#123;</span></span><br><span class="line">        <span class="comment">//     res.end(data);</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        fs.readFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'submit.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">           <span class="comment">// res.end(data);</span></span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="comment">//  res.end('添加页面');</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.url.indexOf(<span class="string">"/resource"</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">        res.setHeader(<span class="string">"content-type"</span>,mime.getType(req.url));</span><br><span class="line">       fs.readFile(path.join(__dirname,req.url),<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">           res.end(data);</span><br><span class="line">       &#125;)</span><br><span class="line">     <span class="comment">//   res.end("静态资源");</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(urlObj.pathname == <span class="string">'/add'</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> news = urlObj.query;</span><br><span class="line">       <span class="comment">//获取表单数据   urlObj.query</span></span><br><span class="line">       fs.readFile(path.join(__dirname,<span class="string">'data.json'</span>),<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,newslist</span>)</span>&#123;</span><br><span class="line">           newslist = <span class="built_in">JSON</span>.parse(newslist || <span class="string">'[]'</span>);</span><br><span class="line">           <span class="comment">//增加id</span></span><br><span class="line">           news.id = newslist.length == <span class="number">0</span> ? <span class="number">1</span> : newslist[newslist.length <span class="number">-1</span> ].id + <span class="number">1</span> ;</span><br><span class="line">           newslist.push(news);</span><br><span class="line">           fs.writeFile(path.join(__dirname,<span class="string">'data.json'</span>),Json.stringify(newslist),<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             <span class="comment">//  res.end('ok');</span></span><br><span class="line">               <span class="comment">//跳转到首页 并展示</span></span><br><span class="line">               <span class="comment">//设置状态码</span></span><br><span class="line">               res.statusCode = <span class="number">302</span>;</span><br><span class="line">               <span class="comment">//设置状态信息</span></span><br><span class="line">               res.statusMessage = <span class="string">"Found"</span>;</span><br><span class="line">               <span class="comment">//设置响应头中的location</span></span><br><span class="line">               res.setHeader(<span class="string">'location'</span>,<span class="string">'/index'</span>);</span><br><span class="line">               <span class="comment">//结束响应</span></span><br><span class="line">               res.end();</span><br><span class="line">           &#125;)</span><br><span class="line">       &#125;)</span><br><span class="line">        <span class="comment">//存储到data.json</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.statusCode = <span class="number">404</span>;</span><br><span class="line">        res.statusMessage = <span class="string">"Not Found"</span>;</span><br><span class="line">        res.end(<span class="string">"Not Found"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="21-封装读取数据的方法"><a href="#21-封装读取数据的方法" class="headerlink" title="21.封装读取数据的方法"></a>21.封装读取数据的方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> FILEPATH = path.join(__dirname,<span class="string">'data.json'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readfile</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">    fs.readFile(FILEPATH,<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">        data = <span class="built_in">JSON</span>.parse(data || <span class="string">"[]"</span>);</span><br><span class="line">        callback(data);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//回调即可</span></span><br><span class="line">readfile(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(newslist);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="22-封装写数据的方法"><a href="#22-封装写数据的方法" class="headerlink" title="22. 封装写数据的方法"></a>22. 封装写数据的方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">writefile</span>(<span class="params">data,callback</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//读取原有数据</span></span><br><span class="line">    <span class="comment">//设置新数据的id</span></span><br><span class="line">    data.id = newslist.length == <span class="number">0</span> ? <span class="number">1</span> : newslist[newslist.length - <span class="number">1</span>] + <span class="number">1</span> ;</span><br><span class="line">    readfile(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//将新数据写入原有数据</span></span><br><span class="line">        newslist.push(data);</span><br><span class="line">        fs.writeFile(FILEPATH,<span class="built_in">JSON</span>.stringify(newslist),<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">             callback();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">writefile(&#123;<span class="attr">title</span>:<span class="string">""</span>,&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ok"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="23-封装render函数进行模板渲染"><a href="#23-封装render函数进行模板渲染" class="headerlink" title="23.封装render函数进行模板渲染"></a>23.封装render函数进行模板渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render_tpl</span>(<span class="params">filename,data,res</span>)</span>&#123;</span><br><span class="line">    fs.readFile(path.join(__dirname,<span class="string">'views'</span>,filename + <span class="string">'.html'</span>),<span class="function"><span class="keyword">function</span>(<span class="params">err,tpl</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> render = template.compile(tpl.toString());</span><br><span class="line">        <span class="keyword">var</span> result = render(data);</span><br><span class="line">        res.end(result);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="24-封装读取id对应的数据"><a href="#24-封装读取id对应的数据" class="headerlink" title="24. 封装读取id对应的数据"></a>24. 封装读取id对应的数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getdatabyid</span>(<span class="params">id,callback</span>)</span>&#123;</span><br><span class="line">    readfile(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> news = newslist.find(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> v.id = id;</span><br><span class="line">        &#125;)</span><br><span class="line">        callback(news);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="25-模块化"><a href="#25-模块化" class="headerlink" title="25. 模块化"></a>25. 模块化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>定义模块</span><br><span class="line">一个js文件就是一个模块,每个模考有自己单独的作用域,防止相互影响.</span><br><span class="line"><span class="number">2.</span>引用模块</span><br><span class="line"><span class="built_in">require</span>函数引用模块</span><br><span class="line"><span class="number">3.</span>模块化的导出</span><br><span class="line">   <span class="built_in">module</span>.exports 默认是一个空对象 给该对象添加属性,将内容导出;</span><br><span class="line">   <span class="built_in">module</span>.exports.名称 =  要导出的内容</span><br><span class="line">   exports.名称 = 要导出的内容</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">var</span> 导出项 = <span class="built_in">require</span>(<span class="string">'模块路径'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="26-模块化标准"><a href="#26-模块化标准" class="headerlink" title="26. 模块化标准"></a>26. 模块化标准</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>AMD:异步模块定义 <span class="built_in">require</span>.js 依赖前置</span><br><span class="line"><span class="number">2.</span>CMD:通用模块定义 sea.js  依赖延迟(后置)</span><br><span class="line"><span class="number">3.</span>CommonJs: Node.Js模块化标准</span><br></pre></td></tr></table></figure>

<h3 id="27-封装页面跳转函数"><a href="#27-封装页面跳转函数" class="headerlink" title="27. 封装页面跳转函数"></a>27. 封装页面跳转函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.statasCode = <span class="number">302</span>;</span><br><span class="line">        <span class="keyword">this</span>.statusMessage = <span class="string">"Found"</span>;</span><br><span class="line">        <span class="keyword">this</span>.setHeader(<span class="string">'location'</span>,url);</span><br><span class="line">        <span class="keyword">this</span>.end();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="28-Express介绍及路由注册方式"><a href="#28-Express介绍及路由注册方式" class="headerlink" title="28. Express介绍及路由注册方式"></a>28. Express介绍及路由注册方式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Express:基于node.js的web开发框架.</span><br><span class="line">npm install express <span class="comment">//下载资源</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);<span class="comment">//引入资源包</span></span><br><span class="line"><span class="keyword">var</span> app = express(); <span class="comment">//创建实例</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> app.METHOD方式,请求方式必须与方法名一致;请求路径必须与注册路径一致;</span><br><span class="line">app.get(路由路径,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;),</span><br><span class="line">app.post(路由路径,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br><span class="line"><span class="number">2.</span> app.all 方式:任意请求方式都可以,请求路径必须与注册路由一致;</span><br><span class="line">app.all(路由路径,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br><span class="line"><span class="number">3.</span> app.use方式:任意请求方式都可以,请求路径只要以注册路由路径开头即可!省略路由路径,默认为<span class="string">"/"</span></span><br><span class="line">app.use(路由路径,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="29-Express中req-res新增方法与属性"><a href="#29-Express中req-res新增方法与属性" class="headerlink" title="29.Express中req,res新增方法与属性"></a>29.Express中req,res新增方法与属性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> response</span><br><span class="line">    res.send(); <span class="comment">//向浏览器相应数据 ,可接受的参数:对象,数组,字符串,数字(作为状态码使用),buffer对象</span></span><br><span class="line">    res.download(path.join(__dirname,<span class="string">'1.jpg'</span>),<span class="string">''</span>);<span class="comment">//向浏览器响应文件 并下载</span></span><br><span class="line">    res.status(<span class="number">404</span>).end();</span><br><span class="line">    res.json(&#123;<span class="attr">name</span>:<span class="string">"assasin"</span>,<span class="attr">age</span>:<span class="number">25</span>&#125;);</span><br><span class="line">    res.jsonp(&#123;<span class="attr">name</span>:<span class="string">"assasin"</span>,<span class="attr">age</span>:<span class="number">25</span>&#125;);<span class="comment">//返回jsonp合适的数据,请求时需要传递callback函数</span></span><br><span class="line">    res.redirect(<span class="string">"http://baidu.com"</span>);<span class="comment">//重定向</span></span><br><span class="line">    res.sendFile(path.join(__dirname,<span class="string">'1.jpg'</span>)); <span class="comment">//返回文件至浏览器</span></span><br><span class="line"><span class="number">2.</span> request</span><br><span class="line">    req.body; <span class="comment">//获取POST请求参数,但不能直接使用</span></span><br><span class="line">    req.query; <span class="comment">//获取GET请求参数,返回对象 可直接使用</span></span><br><span class="line">    req.originalUrl; <span class="comment">//获取原始url地址 类似于req.url</span></span><br><span class="line">    req.params; <span class="comment">//获取路由参数 返回参数对象</span></span><br></pre></td></tr></table></figure>

<h3 id="30-Express托管静态资源"><a href="#30-Express托管静态资源" class="headerlink" title="30. Express托管静态资源"></a>30. Express托管静态资源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">'public'</span>));</span><br></pre></td></tr></table></figure>

<h3 id="31-Express中间件"><a href="#31-Express中间件" class="headerlink" title="31.Express中间件"></a>31.Express中间件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">中间件起始是一个函数,参数是req,res,next;next响应下一个请求</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/index'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//要么结束响应,要么调起下一个</span></span><br><span class="line">    next();</span><br><span class="line">    <span class="comment">//express默认有一个中间件,用来兜底的</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="32-获取POST请求参数"><a href="#32-获取POST请求参数" class="headerlink" title="32.获取POST请求参数"></a>32.获取POST请求参数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">通过req.body 可以获取POST请求参数,但必须使用body-parser中间件;</span><br><span class="line">npm install body-parser</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line">app.use(bodyParser.urlencoded());</span><br><span class="line">app.post(<span class="string">'/api'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.body);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="33-自己实现body-parser中间件"><a href="#33-自己实现body-parser中间件" class="headerlink" title="33.自己实现body-parser中间件"></a>33.自己实现body-parser中间件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//获取Post请求参数,添加给req作为body属性</span></span><br><span class="line">    <span class="keyword">var</span> bufferlist = [];</span><br><span class="line">    req.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">        bufferlist.push(chunk);</span><br><span class="line">    &#125;)</span><br><span class="line">    req.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result = Buffer.concat(bufferlist);</span><br><span class="line">        <span class="keyword">var</span> result = result.toString()</span><br><span class="line">        <span class="comment">//判断浏览器请求时发送的数据格式</span></span><br><span class="line">       <span class="comment">// console.log(get('content-type'));</span></span><br><span class="line">        <span class="keyword">if</span>(req.get(<span class="string">'content-type'</span>).indexOf(<span class="string">'json'</span>) != <span class="number">-1</span>)&#123;</span><br><span class="line">            req.body = <span class="built_in">JSON</span>.parse(result);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.get(<span class="string">'content-type'</span>).indexOf(<span class="string">'urlencoded'</span>) != <span class="number">-1</span>)&#123;</span><br><span class="line">            req.body = querystring.parse(result);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            req.body =  &#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'./add'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.body);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="34-Express中模板引擎使用"><a href="#34-Express中模板引擎使用" class="headerlink" title="34. Express中模板引擎使用"></a>34. Express中模板引擎使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模板引擎的使用  app.engine(后缀名,require('express-art-template')) 用于为指定的后缀的模板指定对应的模板引擎</span></span><br><span class="line"><span class="comment">// npm install art-template</span></span><br><span class="line"><span class="comment">// npm install express-art-template</span></span><br><span class="line"><span class="comment">// 1.定义 HTML 对应的模板引擎</span></span><br><span class="line">app.engine(<span class="string">'html'</span>,<span class="built_in">require</span>(<span class="string">'express-art-template'</span>));</span><br><span class="line"><span class="comment">// 2. 设置模板引擎所在目录,若不设置,默认去views中去找</span></span><br><span class="line"><span class="comment">//app.set('views',要指定的模板文件所在目录路径)</span></span><br><span class="line">app.set(<span class="string">'views'</span>,path.join(__dirname,<span class="string">'views'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 设置模板文件的默认后缀,调用render方法时文件后缀</span></span><br><span class="line">app.set(<span class="string">'view engine'</span>,<span class="string">'html'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="35-Express-hacker-news"><a href="#35-Express-hacker-news" class="headerlink" title="35.  Express-hacker-news"></a>35.  Express-hacker-news</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>资源包</span><br><span class="line">npm install express</span><br><span class="line">npm install art-template</span><br><span class="line">npm install express-art-template</span><br><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span> app.js</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> storage = <span class="built_in">require</span>(<span class="string">'./storage'</span>);</span><br><span class="line"></span><br><span class="line">app.use(<span class="built_in">require</span>(<span class="string">'body-parser'</span>).urlencoded());</span><br><span class="line">app.use(<span class="built_in">require</span>(<span class="string">'body-parser'</span>).json());</span><br><span class="line">app.use(<span class="string">'/resources'</span>,express.static(<span class="string">'resources'</span>));<span class="comment">//静态资源</span></span><br><span class="line"><span class="comment">//配置模板引擎</span></span><br><span class="line">app.engine(<span class="string">'html'</span>,<span class="built_in">require</span>(<span class="string">'express-art-template'</span>));</span><br><span class="line">app.set(<span class="string">'view engine'</span>,<span class="string">'html'</span>);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/index'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//读取数据</span></span><br><span class="line">    storage.getallnews(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">        res.render(<span class="string">'index'</span>,&#123;<span class="attr">list</span>:newslist&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//res.sendFile(path.join(__dirname,'views','index.html'));</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/details'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.getnewsbyid(req.query.id,<span class="function"><span class="keyword">function</span>(<span class="params">news</span>)</span>&#123;</span><br><span class="line">        res.render(<span class="string">'details'</span>,&#123;<span class="attr">item</span>:newslist&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//res.sendFile(path.join(__dirname,'views','details.html'));</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/submit'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    res.sendFile(path.join(__dirname,<span class="string">'views'</span>,<span class="string">'submit.html'</span>));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/add'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.addnews(req.query,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        res.redirect(<span class="string">'index'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">app.post(<span class="string">'/add'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.addnews(req.body,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        res.redirect(<span class="string">'index'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">app.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span> storage.js</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> NEWSPATH = path.join(__dirname,<span class="string">'data.js'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//读取所有数据</span></span><br><span class="line">    getallnews:<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">        fs.readfile(NEWSPATH,<span class="string">'utf8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            data = <span class="built_in">JSON</span>.parse(data || <span class="string">'[]'</span>);</span><br><span class="line">            callback(data);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//读取id</span></span><br><span class="line">    getnewsbyid:<span class="function"><span class="keyword">function</span>(<span class="params">id,callback</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getallnews(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> news = newslist.find(<span class="function"><span class="keyword">function</span>(<span class="params">v,i</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> v.id == id;</span><br><span class="line">            &#125;)</span><br><span class="line">            callback(news);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    addnews:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.getallnews(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">           news.id = newslist.length==<span class="number">0</span>?<span class="number">1</span>:newslist[newslist.length <span class="number">-1</span> ].id +<span class="number">1</span> ;</span><br><span class="line">           newslist.push(news);</span><br><span class="line">           fs.writefile(NEWSPATH,<span class="built_in">JSON</span>.stringify(newslist),<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">               callback();</span><br><span class="line">           &#125;)</span><br><span class="line">       &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="36-Mongodb"><a href="#36-Mongodb" class="headerlink" title="36. Mongodb"></a>36. Mongodb</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>启动mongodb服务: mongod --dbpath 数据库文件所在目录</span><br><span class="line">                  mongo --host <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> --port <span class="number">27017</span></span><br><span class="line"><span class="number">2.</span>连接操作mongodb: mongo</span><br><span class="line"><span class="number">3.</span>查看现有数据库: show databases;</span><br><span class="line"><span class="number">3.</span>切换数据库: use 数据库名;</span><br><span class="line"><span class="number">4.</span>查看数据库中所有集合: show collections;</span><br><span class="line"><span class="number">5.</span>增: db.集合名称.insert(数据对象)</span><br><span class="line">      db.集合名称.insertMany([数据对象<span class="number">1</span>,数据对象<span class="number">2</span>])</span><br><span class="line"><span class="number">6.</span>删: db.集合名称.deleteOne(条件对象)</span><br><span class="line">      db.集合名称.deleteMany(条件对象)</span><br><span class="line"><span class="number">7.</span>改: db.集合名称.updateOne(条件对象,操作对象)</span><br><span class="line">      db.集合名称.updateMany(条件对象,操作对象)</span><br><span class="line">      db.db.users.updateMany(&#123;<span class="attr">name</span>:<span class="string">'shibin'</span>&#125;,&#123;<span class="attr">$set</span>:&#123;<span class="attr">age</span>:<span class="number">18</span>&#125;&#125;) <span class="comment">//修改name=shibin的年龄为18</span></span><br><span class="line"><span class="number">8.</span>查:  db.集合名称.find() <span class="comment">//查询所有数据</span></span><br><span class="line">       db.集合名称.find(条件对象)  <span class="comment">//条件查询</span></span><br><span class="line">       条件对象 &#123;<span class="attr">age</span>:&#123;<span class="attr">$gte</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//年龄大于等于18</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$lt</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//小于</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$gt</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//大于</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$lte</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//小于等于</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$gte</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//大于等于</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$ne</span>:<span class="number">18</span>&#125;&#125; <span class="comment">//不等于</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$in</span>:[<span class="number">18</span>,<span class="number">28</span>]&#125;&#125; <span class="comment">//在一个范围内</span></span><br><span class="line">        &#123;<span class="attr">age</span>:&#123;<span class="attr">$nin</span>:[<span class="number">18</span>,<span class="number">28</span>]&#125;&#125; <span class="comment">//不在这个范围内</span></span><br></pre></td></tr></table></figure>

<h3 id="37-Nodejs操作Mongodb"><a href="#37-Nodejs操作Mongodb" class="headerlink" title="37. Nodejs操作Mongodb"></a>37. Nodejs操作Mongodb</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">npm install mongodb  </span><br><span class="line"><span class="comment">//1. 引入mongo客户端</span></span><br><span class="line"><span class="keyword">var</span>  mongoClient = <span class="built_in">require</span>(<span class="string">'mongodb'</span>).MongoClient;</span><br><span class="line"><span class="comment">//2. 创建连接字符串</span></span><br><span class="line"><span class="keyword">var</span> connStr = <span class="string">"mongodb://localhost:27017"</span>;</span><br><span class="line"><span class="comment">//3.调用mongoClient 方法 connect() 进行连接</span></span><br><span class="line">mongoClient.connect(connStr,<span class="function"><span class="keyword">function</span>(<span class="params">err,client</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//console.log('ok');</span></span><br><span class="line">    <span class="comment">//client数据库客户端对象</span></span><br><span class="line">    <span class="comment">//进行数据库增删改查操作</span></span><br><span class="line">    <span class="keyword">var</span> db = client.db(<span class="string">'test'</span>);</span><br><span class="line">    <span class="comment">//通过dbd对象操作数据库集合</span></span><br><span class="line">    <span class="keyword">var</span> users = db.collection(<span class="string">'users'</span>);</span><br><span class="line">    <span class="comment">//新增数据</span></span><br><span class="line">    <span class="comment">//db.collection('users').insert();</span></span><br><span class="line">    users.insert(&#123;<span class="attr">name</span>:<span class="string">"史俊祥"</span>,<span class="attr">age</span>:<span class="number">25</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,dbresult</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(dbresult.result);</span><br><span class="line">    &#125;)</span><br><span class="line">    users.insertMany([&#123;<span class="attr">name</span>:<span class="string">"www"</span>,<span class="attr">age</span>:<span class="number">28</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">"qqq"</span>,<span class="attr">age</span>:<span class="number">21</span>&#125;],<span class="function"><span class="keyword">function</span>(<span class="params">err,dbresult</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(dbresult.result);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//查询数据</span></span><br><span class="line">    users.find(&#123;<span class="attr">age</span>:<span class="number">18</span>&#125;).toArray(<span class="function"><span class="keyword">function</span>(<span class="params">err,arr</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(arr);</span><br><span class="line">    &#125;)</span><br><span class="line">    users.find(&#123;<span class="attr">age</span>:&#123;<span class="attr">$gt</span>:<span class="number">18</span>&#125;&#125;).toArray(<span class="function"><span class="keyword">function</span>(<span class="params">err,arr</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(arr);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//删除数据</span></span><br><span class="line">    users.deleteOne(&#123;<span class="attr">age</span>:<span class="number">18</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,dbreslt</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(dbreslt.result);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//修改数据</span></span><br><span class="line">    users.updateOne(&#123;<span class="attr">age</span>:<span class="number">28</span>&#125;,&#123;<span class="attr">$set</span>:&#123;<span class="attr">sex</span>:<span class="string">'female'</span>&#125;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,dbresult</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(dbresult.result);</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//最后一步,关闭数据库链接</span></span><br><span class="line">    client.close();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="38-创建storage-js操作Mongodb"><a href="#38-创建storage-js操作Mongodb" class="headerlink" title="38. 创建storage.js操作Mongodb"></a>38. 创建storage.js操作Mongodb</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoClient = <span class="built_in">require</span>(<span class="string">'mongodb'</span>).MongoClient;</span><br><span class="line"><span class="keyword">var</span> ObjectId = <span class="built_in">require</span>(<span class="string">'mongodb'</span>).ObjectId;</span><br><span class="line"><span class="keyword">var</span> connStr = <span class="string">"mongodb://localhost:27017"</span>;</span><br><span class="line"><span class="keyword">var</span> DBNAME = <span class="string">'test'</span>;</span><br><span class="line"><span class="keyword">var</span> COLLECTION_NAME = <span class="string">'news'</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    getallnews:<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">        mongoClient.connect(connStr,<span class="function"><span class="keyword">function</span>(<span class="params">err,client</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> db = client.db(DBNAME);</span><br><span class="line">            <span class="keyword">var</span> news = db.collection(COLLECTION_NAME);</span><br><span class="line"></span><br><span class="line">            news.find().toArray(<span class="function"><span class="keyword">function</span>(<span class="params">err,arr</span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(arr);</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//关闭数据库链接</span></span><br><span class="line">            client.close();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    getnewsbuid:<span class="function"><span class="keyword">function</span>(<span class="params">id,callback</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//将mongodb中的_id 转化 Objectid</span></span><br><span class="line">        <span class="comment">// 将 ObjectId('njbfjdjfskdj45s4df54dsf') 传进去即可;</span></span><br><span class="line">        mongoClient.connect(connStr,<span class="function"><span class="keyword">function</span>(<span class="params">err,client</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> db = client.db(DBNAME);</span><br><span class="line">            <span class="keyword">var</span> news = db.collection(COLLECTION_NAME);</span><br><span class="line">            db.find(&#123;<span class="attr">_id</span>:id&#125;).toArray(<span class="function"><span class="keyword">function</span>(<span class="params">err,arr</span>)</span>&#123;</span><br><span class="line">                callback(arr[<span class="number">0</span>]);<span class="comment">//取数组第一项即可</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//关闭数据库链接</span></span><br><span class="line">            client.close();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    addnews:<span class="function"><span class="keyword">function</span>(<span class="params">info,callback</span>)</span>&#123;</span><br><span class="line">        mongoClient.connect(connStr,<span class="function"><span class="keyword">function</span>(<span class="params">err,client</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> db = client.db(DBNAME);</span><br><span class="line">            <span class="keyword">var</span> news = db.collection(COLLECTION_NAME);</span><br><span class="line">            <span class="comment">//添加数据</span></span><br><span class="line">            news.insertOne(info,<span class="function"><span class="keyword">function</span>(<span class="params">err,dbresult</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(dbresult.result.ok == <span class="number">1</span>)&#123;</span><br><span class="line">                    callback();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//关闭数据库链接</span></span><br><span class="line">            client.close();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="39-hacker-news-api"><a href="#39-hacker-news-api" class="headerlink" title="39. hacker-news-api"></a>39. hacker-news-api</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">前后端分离实现数据接口</span><br><span class="line">api.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> storage = <span class="built_in">require</span>(<span class="string">'storage'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置cors跨域</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Origin"</span>,<span class="string">"*"</span>);</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Method"</span>,<span class="string">"GET,PUT,POST,DELETE"</span>);</span><br><span class="line">    res.header(<span class="string">"Access-Control-Allow-Headers"</span>,<span class="string">"Content-Type"</span>);</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">'/newslist'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.getallnews(<span class="function"><span class="keyword">function</span>(<span class="params">newslist</span>)</span>&#123;</span><br><span class="line">        res.send(&#123;</span><br><span class="line">            errCode:<span class="number">200</span>,</span><br><span class="line">            msg:<span class="string">'success'</span>,</span><br><span class="line">            data:newslist</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">api.get(<span class="string">'/details'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.getnewsbyid(req.query.id,<span class="function"><span class="keyword">function</span>(<span class="params">news</span>)</span>&#123;</span><br><span class="line">        res.send(&#123;</span><br><span class="line">            errCode:<span class="number">200</span>,</span><br><span class="line">            msg:<span class="string">'success'</span>,</span><br><span class="line">            data:news</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">'/addnews'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">    storage.addnews(req.query,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        res.send(&#123;</span><br><span class="line">            errCode:<span class="number">200</span>,</span><br><span class="line">            msg:<span class="string">"success"</span>,</span><br><span class="line">            data:<span class="string">''</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8888</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"http://localhost:8888"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="40-npm上传资源包"><a href="#40-npm上传资源包" class="headerlink" title="40. npm上传资源包"></a>40. npm上传资源包</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm 官方网站注册账号</span><br><span class="line"><span class="number">1.</span> npm init 初始化资源包</span><br><span class="line"><span class="number">2.</span> 创建资源包</span><br><span class="line"><span class="number">3.</span> nrm use npm 切换至npm</span><br><span class="line"><span class="number">4.</span> npm login  登录npm</span><br><span class="line"><span class="number">5.</span> npm publish 发布资源包(不能与npm已有资源命名冲突)</span><br><span class="line"><span class="number">6.</span> npm version major/minnor/patch  修改版本号</span><br></pre></td></tr></table></figure>

<h3 id="41-npm编写命令行工具"><a href="#41-npm编写命令行工具" class="headerlink" title="41. npm编写命令行工具"></a>41. npm编写命令行工具</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 创建资源包</span><br><span class="line"><span class="number">2.</span> 实现命令行工具的功能</span><br><span class="line"><span class="number">3.</span> 在package.json中增加</span><br><span class="line">   <span class="string">"bin"</span>:&#123;</span><br><span class="line">    <span class="string">"mkassasindir"</span>:<span class="string">"./index.js"</span></span><br><span class="line">    <span class="comment">//命令别名:执行文件路径</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="number">4.</span> 在资源最上方添加 #! node</span><br><span class="line"><span class="number">5.</span> 上传资源包至npm  npm publish</span><br><span class="line"><span class="number">6.</span> 全局安装  npm install 资源包名 -g</span><br><span class="line"><span class="number">7.</span> 执行自己的命令行</span><br></pre></td></tr></table></figure>

<h3 id="42-ES6语法"><a href="#42-ES6语法" class="headerlink" title="42. ES6语法"></a>42. ES6语法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">ES6新增功能:</span><br><span class="line"><span class="number">1.</span> 变量声明的方式 <span class="keyword">let</span></span><br><span class="line"><span class="keyword">let</span> 变量名  (不能重复声明;有块级作用域)</span><br><span class="line"><span class="number">2.</span> <span class="keyword">const</span>声明常量 不可重复声明;也有块级作用域;不能被修改值;</span><br><span class="line"><span class="number">3.</span> 对象的简写形式</span><br><span class="line">   属性简写:属性名与属性值的变量名同名;</span><br><span class="line">   方法简写:</span><br><span class="line">   <span class="keyword">let</span> obj&#123;</span><br><span class="line">     sing:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">'sing'</span>)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   可写成</span><br><span class="line">   <span class="keyword">let</span> obj&#123;</span><br><span class="line">     sing () &#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">'sing'</span>)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="number">4.</span>  对象解构赋值</span><br><span class="line"><span class="keyword">let</span> &#123;对象的属性名:要声明的变量名&#125; = 对象</span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">name</span>:name&#125; = obj; <span class="comment">//将对象的name属性值赋值给name变量</span></span><br><span class="line"><span class="number">5.</span> <span class="keyword">import</span> &#123;要导入的内容<span class="number">1</span>,要导入的内容<span class="number">2</span>&#125; <span class="keyword">from</span> <span class="string">"模块"</span></span><br><span class="line"><span class="number">6.</span> 数组解构赋值</span><br><span class="line">    <span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">let</span> [num1,num2,num3,num4] = arr;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]; <span class="comment">//剩余元素只能有一个;只能为最后一个元素</span></span><br><span class="line">    <span class="keyword">let</span> [num1,...num2] = arr; <span class="comment">// [ 2, 3, 4, 5 ]</span></span><br><span class="line"><span class="number">7.</span> 箭头函数</span><br><span class="line">   <span class="keyword">let</span> func2 = <span class="function">(<span class="params">参数列表</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2222</span>);<span class="comment">//函数体</span></span><br><span class="line">  &#125;</span><br><span class="line">  func2();</span><br><span class="line">  ###简写形式###</span><br><span class="line">  如果参数列表中只有一个参数,那么参数()可以省略;</span><br><span class="line">   <span class="keyword">let</span> f1 = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(a *<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> f2 = <span class="function"><span class="params">a</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(a *<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  f2(<span class="number">10</span>);</span><br><span class="line">  如果箭头函数的函数体只有一句代码,函数体的&#123;&#125;可以省略;</span><br><span class="line">  <span class="keyword">let</span> f1 = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a *<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">let</span> f3 = <span class="function"><span class="params">a</span> =&gt;</span> <span class="built_in">console</span>.log(a / <span class="number">10</span>);</span><br><span class="line">  如果箭头函数的函数体只有一句代码,并且这句代码是返回语句,那么<span class="keyword">return</span>与&#123;&#125;都可省略;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="function">(<span class="params">a,b</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  a +b ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> sum = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a+ b;</span><br><span class="line"><span class="number">8.</span> <span class="keyword">this</span>的用法</span><br><span class="line">   <span class="keyword">this</span>的四种调用模式:</span><br><span class="line">   函数调用: <span class="keyword">this</span>---&gt;<span class="built_in">window</span>  函数名()</span><br><span class="line">   方法调用: <span class="keyword">this</span>---&gt;调用 方法的对象  对象.方法名()</span><br><span class="line">   构造函数调用:<span class="keyword">this</span>---&gt;创建出来的实例 <span class="keyword">new</span> 函数名()</span><br><span class="line">   上下文调用模式:<span class="keyword">this</span>---&gt;call和apply的第一个参数 函数名.call()</span><br><span class="line">   </span><br><span class="line">   箭头函数中没有<span class="keyword">this</span>,若果使用<span class="keyword">this</span>,<span class="keyword">this</span>会向上一级作用域中查找.</span><br><span class="line">   使用<span class="keyword">var</span> that = <span class="keyword">this</span>的场景全都可以使用箭头函数解决</span><br><span class="line">   <span class="comment">// let obj = &#123;</span></span><br><span class="line"><span class="comment">//     name :"纯生",</span></span><br><span class="line"><span class="comment">//     say ()&#123;</span></span><br><span class="line"><span class="comment">//         var that = this ;</span></span><br><span class="line"><span class="comment">//         setTimeout(function()&#123;</span></span><br><span class="line"><span class="comment">//             console.log("我叫"+that.name);</span></span><br><span class="line"><span class="comment">//         &#125;,1000)</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name :<span class="string">"纯生"</span>,</span><br><span class="line">    say ()&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"我叫"</span>+<span class="keyword">this</span>.name);</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.say();</span><br><span class="line"><span class="number">9.</span> 箭头函数中没有<span class="built_in">arguments</span>的说明:</span><br><span class="line">   <span class="built_in">arguments</span>在函数被调用时,会将所有的实参存贮到<span class="built_in">arguments</span>对象中</span><br><span class="line">   使用场景:传递参数个数不确定时,使用<span class="built_in">arguments</span>获取所有实参</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; <span class="built_in">arguments</span>.length;i++)&#123;</span><br><span class="line">        result += <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  res = sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line"><span class="number">10.</span> 剩余参数 rest params 只能有一个,并且只能是参数列表的最后一个</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">b,...a</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">  &#125;</span><br><span class="line">  func(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">  箭头函数获取不定个数的参数,就可使用剩余参数.</span><br><span class="line"><span class="number">11.</span> 函数参数默认值的使用</span><br><span class="line"><span class="number">12.</span> 使用变量值作为属性名:</span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">"name"</span>;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">        [key]:<span class="string">"assasin"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="number">13.</span> 对象扩展运算符</span><br><span class="line">     <span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name :<span class="string">"assasin"</span>,</span><br><span class="line">    age:<span class="number">25</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ass = &#123;</span><br><span class="line">      ...obj</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(ass);</span><br><span class="line"><span class="number">14.</span> 运算符在数组传(参)递时的使用</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a,b,c</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(sum(...arr));</span><br><span class="line"><span class="number">15.</span> Class使用</span><br><span class="line">   <span class="comment">// function Person(name,age)&#123;</span></span><br><span class="line"><span class="comment">//     this.name = name;</span></span><br><span class="line"><span class="comment">//     this.age = age;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//静态方法 es6不支持静态属性</span></span><br><span class="line">    <span class="keyword">static</span> sayhi()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"sayhi方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//构造函数</span></span><br><span class="line">    <span class="keyword">constructor</span>(name,age)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//实例方法</span></span><br><span class="line">    say()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"say方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line"><span class="built_in">console</span>.log(stu);</span><br><span class="line"><span class="built_in">console</span>.log(stu.say());</span><br><span class="line">Person.sayhi();</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">'assasin'</span>,<span class="number">28</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p);</span><br><span class="line"></span><br><span class="line"><span class="number">16.</span><span class="keyword">super</span>调用的原因:</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">"assasin"</span>;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">25</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Person.call(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line"><span class="built_in">console</span>.log(stu);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"assasin"</span>;</span><br><span class="line">        <span class="keyword">this</span>.age = <span class="number">25</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="43-Promise"><a href="#43-Promise" class="headerlink" title="43.Promise"></a>43.Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">promise用于解决回调地域问题.支持promise就可使用.then()方法来使用回调函数,</span><br><span class="line">.then(成功的回调函数,失败的回调函数)</span><br><span class="line">promise对象有三种状态:</span><br><span class="line">① pending:挂起,正在执行</span><br><span class="line">② fullfilled:成功</span><br><span class="line">③ rejected:失败</span><br><span class="line">.then()连写时,需要在回调函数中返回一个新的<span class="built_in">Promise</span>对象</span><br><span class="line"></span><br><span class="line"><span class="comment">//promise APi</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">time</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">       <span class="comment">//要执行的内容</span></span><br><span class="line">       setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="comment">// console.log("1s");</span></span><br><span class="line">           <span class="comment">//异步操作完成后,需要改变当前promise状态即可</span></span><br><span class="line">           <span class="comment">//resolve调用改为成功</span></span><br><span class="line">           <span class="comment">//reject调用艾薇失败</span></span><br><span class="line">           resolve(<span class="number">123</span>);</span><br><span class="line">          <span class="comment">// reject();</span></span><br><span class="line">       &#125;,time)</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">timeout(<span class="number">1000</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//要做的事情</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"1s"</span>,data);</span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">封装ajax:</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//发送ajax请求</span></span><br><span class="line">        <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xhr.open(option.type,option.url);</span><br><span class="line">        xhr.send(<span class="literal">null</span>);</span><br><span class="line">        xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span> )&#123;</span><br><span class="line">                <span class="keyword">if</span>(xhr.status == <span class="number">200</span>)&#123;</span><br><span class="line">                    resolve(xhr.responseText);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    reject();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line">ajax(&#123;</span><br><span class="line">    url:<span class="string">""</span>,</span><br><span class="line">    data:&#123;&#125;,</span><br><span class="line">    type:<span class="string">"get"</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">promise静态方法all,race说明</span><br><span class="line">all:在所有promise异步操作完成后,执行某个任务就可使用</span><br><span class="line">race:在promise第一个异步完成后,就执行某个任务</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a></h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/03/nodejs-2019-study/" data-id="ckc6139t50000h0tqgbkhhvmo" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/07/03/Nginx-%E9%AB%98%E6%80%A7%E8%83%BDHTTP%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Nginx---高性能HTTP和反向代理服务器
        
      </div>
    </a>
  
  
    <a href="/2020/07/03/nodejs%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95-%E8%B0%83%E6%95%B4mongodb-redis-mysql%E6%9C%80%E5%A4%A7%E8%BF%9E%E6%8E%A5%E6%95%B0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">nodejs压力测试(调整mongodb,redis,mysql最大连接数)</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/03/Nginx-%E9%AB%98%E6%80%A7%E8%83%BDHTTP%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/">Nginx---高性能HTTP和反向代理服务器</a>
          </li>
        
          <li>
            <a href="/2020/07/03/nodejs-2019-study/">nodejs-2019-study</a>
          </li>
        
          <li>
            <a href="/2020/07/03/nodejs%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95-%E8%B0%83%E6%95%B4mongodb-redis-mysql%E6%9C%80%E5%A4%A7%E8%BF%9E%E6%8E%A5%E6%95%B0/">nodejs压力测试(调整mongodb,redis,mysql最大连接数)</a>
          </li>
        
          <li>
            <a href="/2020/07/03/%E5%88%A9%E7%94%A8tornado%E6%90%AD%E5%BB%BA%E6%96%87%E6%A1%A3%E9%A2%84%E8%A7%88%E7%B3%BB%E7%BB%9F/">利用tornado搭建文档预览系统</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 assasin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>